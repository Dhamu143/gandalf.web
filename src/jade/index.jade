doctype html
html(ng-app="app")
  head(lang='en')
    meta(charset='UTF-8')
    meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no')
    title Gandalf. We protect you from yo urselves
    link(rel='stylesheet', href='css/app.css')

  body.container.app
    .row
      // .col.col-md-12(ng-controller="AddFieldController")
        include templates/modal/add-field
      .col.col-md-12(ng-controller="MainController")
        .decision-table.ng-cloak(ng-if="table")
          table.table
            thead
              tr
                th #
                th(ng-repeat="condition in table.fields") {{condition.title}}
                th Action
                th.decision-table__add-column
                  a.decision-table__add-column__icon(ng-click="addNewField()") +
                  | Result
            tfoot.table-footer
              tr
                td(colspan="{{table.fields.length + 3}}")
                  .pull-right
                    button.btn.btn-default(ng-click="save()") Save
            tbody
              tr(ng-repeat="rule in table.rules | orderBy: rule.priority")
                td
                  .form-control-static {{$index}}
                td(ng-repeat="condition in rule.conditions")
                  div.form-control-static(ng-if="!rule.isEditing") {{condition.value.toString()}}
                  div(ng-if="rule.isEditing")
                    input.form-control(ng-model="condition.value")
                td
                  .decision-table__actions.form-control-static
                    a.btn.btn-default(ng-click="rule.save()", ng-if="rule.isEditing")
                      i.glyphicon.glyphicon-ok
                    a.btn.btn-default(ng-click="rule.edit()", ng-if="!rule.isEditing")
                      i.glyphicon.glyphicon-pencil
                    a.btn.btn-default(ng-click="table.deleteRule(rule)")
                      i.glyphicon.glyphicon-remove
                td.decision-table__description-wrap
                  div.form-control-static(ng-if="!rule.isEditing") {{rule.result}}
                  div(ng-if="rule.isEditing")
                    input.form-control(ng-model="rule.result")
                  .decision-table__description {{rule.description}}
              tr.decision-table__add-row
                td(colspan="{{table.fields.length + 3}}")
                  a(ng-click="addNewRule()") Add new row

    // build:js js/app.min.js

    script(src='bower_components/angular/angular.js')
    script(src='bower_components/angular-ui-router/release/angular-ui-router.js')
    script(src='bower_components/ngstorage/ngStorage.js')

    script(src='bower_components/angular-bootstrap/ui-bootstrap.js')
    script(src='bower_components/angular-bootstrap/ui-bootstrap-tpls.js')
    script(src='bower_components/jquery/dist/jquery.js')

    script(src='js/config.js')
    script(src='js/modules/gandalf.js')
    script(src='js/app.js')

    script(src='js/controllers/add-field-controller.js')
    // endbuild

